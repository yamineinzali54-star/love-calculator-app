<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Love App üíñ</title>
<link rel="manifest" href="manifest.json">

<style>
body{
    background: linear-gradient(to right, pink, hotpink);
    font-family: Arial;
    text-align: center;
    height: 100vh;
    transition: 0.5s;
}

/* Dark Mode */
body.dark{
    background: linear-gradient(to right, #111, #333);
    color: white;
}

/* Box */
.box{
    background: white;
    width: 300px;
    margin: 80px auto;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 0 15px gray;
    transition: 0.5s;
}

body.dark .box{
    background: #222;
}

/* Input */
input{
    width: 90%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 10px;
    border: 1px solid pink;
}

body.dark input{
    background: #333;
    color: white;
}

/* Button */
button{
    background: hotpink;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    margin: 5px;
}

button:hover{
    background: deeppink;
}

/* Result */
#result{
    margin-top: 10px;
    font-weight: bold;
    opacity: 0;
}

.show{
    animation: fade 1s forwards;
}

@keyframes fade{
    from{opacity:0;}
    to{opacity:1;}
}

/* Hearts */
.heart{
    position: fixed;
    bottom: 0;
    animation: float 4s linear forwards;
}

@keyframes float{
    to{ transform: translateY(-100vh); opacity:0;}
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">

<h3>üîê Login</h3>

<input id="loginUser" placeholder="Username">
<input id="loginPass" type="password" placeholder="Password">

<br>

<button onclick="login()">Login</button>
<button onclick="showRegister()">Register</button>

<p id="loginMsg"></p>

</div>

<!-- REGISTER -->
<div class="box" id="registerBox" style="display:none;">

<h3>üìù Register</h3>

<input id="regUser" placeholder="Username">
<input id="regPass" type="password" placeholder="Password">

<br>

<button onclick="register()">Create</button>
<button onclick="showLogin()">Back</button>

<p id="regMsg"></p>

</div>

<!-- APP -->
<div class="box" id="appBox" style="display:none;">

<h3>üíñ Love Calculator</h3>

<input id="name1" placeholder="Your Name">
<input id="name2" placeholder="Partner Name">

<br>

<button onclick="calculate()">Calculate üíò</button>
<button onclick="toggleDark()">üåô</button>
<button onclick="logout()">Logout üö™</button>

<div id="result"></div>

</div>

<!-- Sound -->
<audio id="sound">
<source src="https://8985935-by-marsel-mihaylov.mp3.pm/song/214147311-best-love-songs-and-greatest-romantic-english-acoustic-love-songs-happiness-mix-2022/">
</audio>

<script>

let sound = document.getElementById("sound");

/* Check Login */
if(localStorage.getItem("user")){
    showApp();
}

/* Screens */
function showLogin(){
    hideAll();
    loginBox.style.display="block";
}

function showRegister(){
    hideAll();
    registerBox.style.display="block";
}

function showApp(){
    hideAll();
    appBox.style.display="block";
}

function hideAll(){
    loginBox.style.display="none";
    registerBox.style.display="none";
    appBox.style.display="none";
}

/* Register */
function register(){

    let u = regUser.value;
    let p = regPass.value;

    if(u=="" || p==""){
        regMsg.innerText="Fill all fields!";
        return;
    }

    localStorage.setItem("user_"+u, p);

    regMsg.innerText="Registered! Login now ‚úÖ";
}

/* Login */
function login(){

    let u = loginUser.value;
    let p = loginPass.value;

    let saved = localStorage.getItem("user_"+u);

    if(saved===p){

        localStorage.setItem("user", u);

        showApp();

    }else{
        loginMsg.innerText="Wrong username/password ‚ùå";
    }
}

/* Logout */
function logout(){
    localStorage.removeItem("user");
    showLogin();
}

/* Love Calc */
function calculate(){

    sound.play();

    let n1 = name1.value;
    let n2 = name2.value;

    if(n1=="" || n2==""){
        alert("Enter names ‚ù§Ô∏è");
        return;
    }

    let love = Math.floor(Math.random()*100)+1;

    result.classList.remove("show");
    void result.offsetWidth;

    result.innerHTML = n1+" ‚ù§Ô∏è "+n2+"<br>"+love+"% üíï";

    result.classList.add("show");

    hearts();
}

/* Hearts */
function hearts(){

    for(let i=0;i<10;i++){

        let h = document.createElement("div");

        h.innerHTML="üíñ";
        h.className="heart";

        h.style.left=Math.random()*100+"vw";
        h.style.fontSize=15+Math.random()*20+"px";

        document.body.appendChild(h);

        setTimeout(()=>h.remove(),4000);
    }
}

/* Dark */
function toggleDark(){
    document.body.classList.toggle("dark");
}

</script>

<script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>

</body>
</html>
